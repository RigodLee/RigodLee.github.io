{"meta":{"title":"does","subtitle":"","description":"","author":"does","url":"http://yoursite.com","root":"/"},"pages":[{"title":"友链","date":"2020-06-07T11:53:53.000Z","updated":"2020-06-07T12:02:51.938Z","comments":true,"path":"link/index.html","permalink":"http://yoursite.com/link/index.html","excerpt":"","text":""},{"title":"分类","date":"2020-06-07T11:52:05.000Z","updated":"2020-06-07T12:04:10.244Z","comments":true,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"标签","date":"2020-06-07T11:50:14.000Z","updated":"2020-06-07T12:02:58.132Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"安卓Service和Broadcast实现简单的音乐播放器","slug":"安卓Service和Broadcast实现简单的音乐播放器","date":"2020-06-07T12:07:40.699Z","updated":"2020-06-07T12:50:15.751Z","comments":true,"path":"2020/06/07/安卓Service和Broadcast实现简单的音乐播放器/","link":"","permalink":"http://yoursite.com/2020/06/07/%E5%AE%89%E5%8D%93Service%E5%92%8CBroadcast%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8/","excerpt":"","text":"title:安卓Service和Broadcast实现简单的音乐播放器tags:移动开发categories:移动开发top_img:https://img-blog.csdnimg.cn/20200607121325601.pngcover:https://img-blog.csdnimg.cn/20200607121325601.png 做实验的时候使用Service和Broadcast实现了一个功能较为简单的音乐播放器，可以对音乐进行播放、暂停和停止。主要思路：1、使用Service在后台播放音乐2、Broadcast发送广播通知Activity更改界面程序运行界面： 图1 播放界面 图2 暂停界面 图3 停止界面 实现代码： 1、布局界面XML如下 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:app=\"http://schemas.android.com/apk/res-auto\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\"&gt; &lt;androidx.appcompat.widget.Toolbar android:id=\"@+id/musicbar\" android:layout_width=\"match_parent\" android:layout_height=\"60dp\" android:background=\"?attr/colorPrimary\" android:minHeight=\"?attr/actionBarSize\" android:theme=\"?attr/actionBarTheme\" app:navigationIcon=\"@drawable/logo\" app:titleTextColor=\"@color/white\" /&gt; &lt;View android:id=\"@+id/view\" android:layout_width=\"match_parent\" android:layout_height=\"100dp\" /&gt; &lt;ImageView android:id=\"@+id/photo\" android:layout_width=\"250dp\" android:layout_height=\"250dp\" android:layout_gravity=\"center\" android:layout_marginBottom=\"20dp\" app:srcCompat=\"@drawable/qielogo\" /&gt; &lt;TextView android:id=\"@+id/musictext\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:layout_gravity=\"center\" android:layout_marginBottom=\"100dp\" android:text=\"暂无播放音乐\" android:textSize=\"28dp\" /&gt; &lt;LinearLayout android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:background=\"@color/white\" android:orientation=\"horizontal\"&gt; &lt;ImageButton android:id=\"@+id/start\" android:layout_width=\"90dp\" android:layout_height=\"90dp\" android:layout_weight=\"1\" android:background=\"@color/white\" android:scaleType=\"centerInside\" app:srcCompat=\"@drawable/start\" /&gt; &lt;ImageButton android:id=\"@+id/stop\" android:layout_width=\"90dp\" android:layout_height=\"90dp\" android:layout_weight=\"1\" android:background=\"@color/white\" android:scaleType=\"centerInside\" app:srcCompat=\"@drawable/stop\" /&gt; &lt;/LinearLayout&gt;&lt;/LinearLayout&gt; 2、主Acitivy如下 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192package com.example.test6;import androidx.appcompat.app.AppCompatActivity;import android.content.BroadcastReceiver;import android.content.Context;import android.content.Intent;import android.content.IntentFilter;import android.os.Bundle;import android.util.Log;import android.view.View;import android.widget.ImageButton;import android.widget.ImageView;import android.widget.TextView;public class Music extends AppCompatActivity &#123; TextView musictext; ImageView photo; ImageButton startbutton; Integer state = 2; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_music); IntentFilter inf = new IntentFilter(); inf.addAction(\"com.user.action\"); registerReceiver(broad,inf); musictext = findViewById(R.id.musictext); photo = findViewById(R.id.photo); startbutton = findViewById(R.id.start); ImageButton stopbutton = findViewById(R.id.stop); startbutton.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; switch (state)&#123; case 1: state = 2; break; default: state = 1; break; &#125; Log.v(\"当前状态\",\"1\"); Intent intent = new Intent(Music.this,MusicService.class); intent.putExtra(\"action\",state); startService(intent); Log.v(\"intent传值\",\"1\"); &#125; &#125;); stopbutton.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; Intent intent = new Intent(Music.this,MusicService.class); stopService(intent); &#125; &#125;); &#125; @Override protected void onDestroy() &#123; super.onDestroy(); unregisterReceiver(broad); &#125; public BroadcastReceiver broad = new BroadcastReceiver() &#123; @Override public void onReceive(Context context, Intent intent) &#123; int i = intent.getIntExtra(\"action\",-1); switch(i)&#123; case 1: musictext.setText(\"China-X\"); photo.setImageResource(R.drawable.yjtp); startbutton.setImageResource(R.drawable.pause); break; case 2: startbutton.setImageResource(R.drawable.start); musictext.setText(\"音乐暂停\"); break; case 3: state = 3; musictext.setText(\"暂无播放音乐\"); photo.setImageResource(R.drawable.qielogo); startbutton.setImageResource(R.drawable.start); break; &#125; &#125; &#125;;&#125; 3、Service类如下 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354package com.example.test6;import android.app.Service;import android.content.Intent;import android.media.MediaPlayer;import android.os.IBinder;import android.util.Log;public class MusicService extends Service &#123; public IBinder onBind(Intent intent)&#123; return null; &#125; private MediaPlayer mp; public void onCreate()&#123; super.onCreate(); &#125; public void onStart(Intent intent,int startId)&#123; super.onStart(intent,startId); int i = intent.getIntExtra(\"action\",0); if(i==1)&#123; if(null==mp) &#123; mp = MediaPlayer.create(this, R.raw.mymusic); mp.setOnCompletionListener(new MediaPlayer.OnCompletionListener() &#123; @Override public void onCompletion(MediaPlayer mp) &#123; stopSelf(); &#125; &#125;); &#125; mp.start(); &#125;else if(i==2)&#123; if(mp!=null&amp;&amp;mp.isPlaying())&#123; mp.pause(); &#125; &#125; Log.v(\"zhuangtai\",String.valueOf(i)); Intent in = new Intent(\"com.user.action\"); in.putExtra(\"action\",i); sendBroadcast(in); &#125; public void onDestroy()&#123; super.onDestroy(); mp.stop(); Intent in = new Intent(\"com.user.action\"); in.putExtra(\"action\",3); sendBroadcast(in); &#125;&#125;","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2020-05-02T06:40:42.967Z","updated":"2020-05-02T06:40:42.968Z","comments":true,"path":"2020/05/02/hello-world/","link":"","permalink":"http://yoursite.com/2020/05/02/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}],"categories":[],"tags":[]}